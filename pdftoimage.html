<!DOCTYPE html>

<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="manifest" href="images/manifest.json" />
    <link rel="icon" href="images/PokeBall.png" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

    <script src="http://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.1/processing-api.min.js"></script>

    <style type="text/css">
        .row {
            margin: 0 auto;
            width: 100%;
        }

        a {
            width: 100%;
            margin: 10px 0;
        }

        html,
        body {
            height: 100%;
        }
    </style>

</head>

<!--
  Created using jsbin.com
  Source can be edited via http://jsbin.com/pdfjs-helloworld-v2/8598/edit
-->

<body>
    <div class="row" style="margin-bottom:100px;">

        <div class="col-md-12">
            <canvas id="the-canvas" style="border:1px solid black; widows: 100px;"></canvas>
            <input id='pdf' type='file' />

            <!-- Use latest PDF.js build from Github -->
            <script type="text/javascript" src="https://rawgithub.com/mozilla/pdf.js/gh-pages/build/pdf.js"></script>

            <script type="text/javascript">
                //
                // Disable workers to avoid yet another cross-origin issue (workers need the URL of
                // the script to be loaded, and dynamically loading a cross-origin script does
                // not work)
                //
                pdfjsLib.disableWorker = true;
                //
                // Asynchronous download PDF as an ArrayBuffer
                //
                var pdf = document.getElementById('pdf');
                pdf.onchange = function (ev) {
                    if (file = document.getElementById('pdf').files[0]) {
                        fileReader = new FileReader();
                        fileReader.onload = function (ev) {
                            console.log(ev);
                            pdfjsLib.getDocument(fileReader.result).then(function getPdfHelloWorld(pdf) {
                                //
                                // Fetch the first page
                                //
                                console.log(pdf)
                                pdf.getPage(1).then(function getPageHelloWorld(page) {
                                    var scale = 1.5;
                                    var viewport = page.getViewport(scale);
                                    //
                                    // Prepare canvas using PDF page dimensions
                                    //
                                    var canvas = document.getElementById('the-canvas');
                                    var context = canvas.getContext('2d');
                                    canvas.height = viewport.height;
                                    canvas.width = viewport.width;
                                    //
                                    // Render PDF page into canvas context
                                    //
                                    var task = page.render({ canvasContext: context, viewport: viewport })
                                    //   task.promise.then(function(){
                                    //     console.log(canvas.toDataURL('image/jpeg'));
                                    //   });
                                });
                            }, function (error) {
                                console.log(error);
                            });
                        };
                        fileReader.readAsArrayBuffer(file);
                    }
                }
            </script>


            <style id="jsbin-css">
            </style>
            <script>
            </script>

        </div>
    </div>

    <div class="row" style="position: absolute; bottom: 5%;">

        <div class="col-md-12">
            <a href="index.html" class="btn btn-success">Back</a>
        </div>
    </div>
</body>

</html>